/**
 * Duck Diver Carousel Plugin - Admin Script
 * Author: Howard Ehrenberg
 * Version: 1.3
 */
jQuery(function(e){"use strict";let s=0;postSelected,taxOptions;let d=0;const o=e("select#dd_owl_post_type"),i=e('input[name="dd_owl_tax_options"]'),t=e("#term-row"),a=e(".is-media"),l=e("#dd_owl_image_size"),n=e('div[data-id="display_post_options"]');function r(){e("#dd-owl-loading").show(),e("span.ajax-loader").show();let s=e("select#dd_owl_post_type").val(),d=e("select#dd_owl_post_taxonomy_type").val(),o=e("input#post_ID").val();e.ajax({url:ajaxurl,type:"POST",data:{posttype:s,taxtype:d,postid:o,action:"owl_carousel_terms"},dataType:"json",success:function(s){e("#taxterm").html(s),e("#dd-owl-loading").hide(),e("span.ajax-loader").hide(),e("body:before").css("display","none"),s.length>234&&t.addClass("visible").removeClass("hidden");let d=e("select#dd_owl_post_taxonomy_term");d.select2({placeholder:"Choose Terms",allowClear:!0}),d.find(":selected").data("selected")},error:function(e){console.log(e)}})}e("#dd_owl_image_wrapper").on("click","a.delete",function(){e(this).closest("li.dd-owl-image-preview").remove()}),e("#dd_shortcode_copy").on("click",function(){let e=document.getElementById("dd_owl_shortcode").innerHTML,s=document.createElement("input");s.setAttribute("value",e),document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),document.getElementById("dd_owl_shortcode").innerHTML="Copied!",setTimeout(function(){document.getElementById("dd_owl_shortcode").innerHTML=e},1e3)}),postSelected=o.val(),taxOptions=e('input[name="dd_owl_tax_options"]:checked').val(),e("#dd_owl_thumbs").on("click",function(){e(this).is(":checked")?e(".image-options").removeClass("hidden"):e(".image-options").addClass("hidden")}),e("#dd_owl_show_cta").on("change",function(){e(this).is(":checked")?e(".show-button").removeClass("hidden"):e(".show-button").addClass("hidden")}),e("select#dd_owl_btn_display").on("change",function(){"inline"!==e(this).val()?e(".button-margin").addClass("visible").removeClass("hidden"):e(".button-margin").addClass("hidden").removeClass("visible")}),o.on("change",function(){let d=e(this).val();e("#dd-owl-loading").show(),e("span.ajax-loader").show(),t.addClass("hidden").removeClass("visible"),a.removeClass("visible").addClass("hidden"),n.removeClass("hidden").addClass("visible"),e("#tax-options").removeClass("hidden").addClass("visible"),d!==postSelected&&(s=0,e("select#dd_owl_post_ids").find("option").remove().end(),i.trigger("change"),postSelected=d),"product"===d?(e(".product-rows").show(),e(".not-media").removeClass("hidden").addClass("visible"),n.removeClass("hidden").addClass("visible")):"attachment"===d?(a.removeClass("hidden").addClass("visible"),e(".not-media").removeClass("visible").addClass("hidden"),e("#tax-options").removeClass("visible").addClass("hidden"),n.removeClass("visible").addClass("hidden")):(e(".product-rows").hide(),e(".not-media").removeClass("hidden").addClass("visible"),a.removeClass("visible").addClass("hidden"),t.addClass("hidden").removeClass("visible"),n.removeClass("hidden").addClass("visible"));let o=e("input#post_ID").val();e.ajax({url:ajaxurl,type:"POST",data:{posttype:d,action:"owl_carousel_tax",postid:o},success:function(s){e("#taxonomy").html(s),r()}})}),i.on("change",function(){let d=e('input[name="dd_owl_tax_options"]:checked').val(),o=e("#dd_owl_post_taxonomy_term"),i=o.length?o.val():-1,a=!1;return!0===i&&(a=!!i.length),"taxonomy"===d?(e("#category-row").removeClass("hidden").addClass("visible"),e("#choose-postids.visible").addClass("hidden").removeClass("visible"),e("#number_of_posts").show(),a&&t.addClass("visible").removeClass("hidden")):"postID"===d?(e("#number_of_posts").hide(),0===s?function(){e("#dd-owl-loading").show(),e("span.ajax-loader").show();let d=e("select#dd_owl_post_type").val(),o=e("input#post_ID").val();e.ajax({url:ajaxurl,type:"POST",data:{posttype:d,carousel_id:o,action:"owl_carousel_posts"},success:function(s){let d=e("#dd_owl_post_ids");d.append(s),e(".dd-owl-multi-select").select2({placeholder:"Choose the posts"}),e("#choose-postids").removeClass("hidden").addClass("visible"),d.show(),e("#dd-owl-loading").hide(),e("span.ajax-loader").hide()},error:function(e){console.log(e)}}),s=1}():(e("#choose-postids").removeClass("hidden").addClass("visible"),e("#dd_owl_post_ids").show()),e("#category-row.visible, #term-row.visible").addClass("hidden").removeClass("visible")):"featured_product"===d?(e("#number_of_posts").show(),e("#category-row.visible, #term-row.visible, #choose-postids").addClass("hidden").removeClass("visible"),t.hide()):"show_tax_only"===d?(e("#category-row").removeClass("hidden").addClass("visible"),e("#choose-postids.visible").addClass("hidden").removeClass("visible"),e("#number_of_posts").show(),a&&t.addClass("visible").removeClass("hidden")):(e("#category-row.visible, #term-row.visible").addClass("hidden").removeClass("visible"),e("#choose-postids.visible").addClass("hidden").removeClass("visible")),!1}),l.on("change",function(){"custom"===l.val()?e(".show-custom").removeClass("hidden").addClass("visible"):e(".show-custom").addClass("hidden").removeClass("visible")}),null!==taxOptions&&0===d&&(i.trigger("change"),d=1),e(document).ready(function(){let s;e("body.post-type-owl-carousel #wpwrap").before('<div id="dd-owl-loading"></div>'),e(".dd_owl_tooltip").tooltip(),e("#dd_owl_image_wrapper").sortable(),o.trigger("change"),l.trigger("change"),e("#dd-owl-add-media").click(function(d){d.preventDefault(),s?s.open():((s=wp.media.frames.file_frame=wp.media({title:dd_owl_admin_script.select_images,button:{text:dd_owl_admin_script.insert_images},multiple:!0})).on("select",function(){let d,o=s.state().get("selection").map(function(e){return e.toJSON(),e}),i=e("#dd_owl_image_wrapper");for(d=0;d<o.length;++d){let e=o[d].attributes.sizes.thumbnail?o[d].attributes.sizes.thumbnail.url:o[d].attributes.url;i.append('<li class="dd-owl-image-preview" id="dd-owl-media-'+o[d].id+'data-media-id="'+o[d].id+'"><img src="'+e+'" alt="'+o[d].attributes.alt+'"><input id="dd-owl-image-input-'+o[d].id+'" type="hidden" name="dd_owl_media_items_array[]"  value="'+o[d].id+'"><ul class="actions"><li><a href="#" class="delete"></a></li></ul></li>')}}),s.open())})}),e("#dd_owl_post_taxonomy_type").on("change",function(){r()})});